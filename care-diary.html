<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="careDiary.title">ê°„ë³‘ì¼ê¸° - ë‡Œì§ˆí™˜ì¼€ì–´</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ </text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .diary-card {
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }
        .diary-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .recording-pulse {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .media-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 10px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 48px;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 48px;
        }
        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
        
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 768px) {
            .btn-primary, .btn-secondary {
                padding: 14px 16px;
                font-size: 14px;
                min-height: 52px;
            }
            .btn-primary i, .btn-secondary i {
                font-size: 16px;
            }
        }
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .status-badge.medication { background: #e3f2fd; color: #1976d2; }
        .status-badge.meal { background: #fff3e0; color: #f57c00; }
        .status-badge.vital { background: #fce4ec; color: #c2185b; }
        .status-badge.recovery { background: #e8f5e9; color: #388e3c; }
    </style>
</head>
<body class="font-sans bg-gray-50">
    
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-2">
                <!-- Logo -->
                <div class="flex items-center space-x-1">
                    <span class="text-base md:text-xl">ğŸ§ </span>
                    <h1 class="text-[10px] md:text-xs font-bold text-primary whitespace-nowrap" data-i18n="site.name">ë‡Œì§ˆí™˜ì¼€ì–´</h1>
                    <span class="hidden md:inline text-xs text-gray-400">|</span>
                    <p class="hidden md:inline text-[10px] md:text-xs text-gray-600 whitespace-nowrap" data-i18n="site.subtitle">Brain Disease Care</p>
                </div>
                
                <!-- Language Switcher -->
                <div class="flex items-center space-x-1">
                    <button onclick="switchLanguage('ko')" class="lang-btn px-2 py-1 rounded-lg bg-transparent hover:bg-gray-100 active:bg-gray-200 transition" data-lang="ko">
                        ğŸ‡°ğŸ‡· <span class="hidden sm:inline">í•œêµ­ì–´</span>
                    </button>
                    <button onclick="switchLanguage('en')" class="lang-btn px-2 py-1 rounded-lg bg-transparent hover:bg-gray-100 active:bg-gray-200 transition" data-lang="en">
                        ğŸ‡ºğŸ‡¸ <span class="hidden sm:inline">English</span>
                    </button>
                    <button onclick="switchLanguage('zh')" class="lang-btn px-2 py-1 rounded-lg bg-transparent hover:bg-gray-100 active:bg-gray-200 transition" data-lang="zh">
                        ğŸ‡¨ğŸ‡³ <span class="hidden sm:inline">ä¸­æ–‡</span>
                    </button>
                    <button onclick="switchLanguage('ja')" class="lang-btn px-2 py-1 rounded-lg bg-transparent hover:bg-gray-100 active:bg-gray-200 transition" data-lang="ja">
                        ğŸ‡¯ğŸ‡µ <span class="hidden sm:inline">æ—¥æœ¬èª</span>
                    </button>
                    
                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-toggle" class="md:hidden ml-4 text-gray-600 hover:text-primary">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Desktop Menu -->
            <div class="hidden md:flex space-x-1 pb-2 overflow-x-auto">
                <a href="index.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.home">í™ˆ</a>
                <a href="disease-info.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.disease">ë‡Œì§ˆí™˜ ì •ë³´</a>
                <a href="hospital.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.hospital">ë³‘ì› ê²€ìƒ‰</a>
                <a href="caregivers.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.caregivers">ê°„ë³‘ì¸</a>
                <a href="care-diary.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap bg-primary text-white" data-i18n="menu.careDiary">ê°„ë³‘ì¼ê¸°</a>
                <a href="medical-lens.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.medicalLens">ë©”ë””ì»¬ ë Œì¦ˆ</a>
                <a href="rehab.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.rehab">ì¬í™œìš´ë™</a>
                <a href="community.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.community">ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="medical.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.medical">ëª…ì˜ì°¾ê¸°</a>
                <a href="emergency.html" class="menu-link px-3 py-1 text-sm rounded-lg hover:bg-primary hover:text-white transition whitespace-nowrap" data-i18n="menu.emergency">ì‘ê¸‰</a>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden pb-4">
                <a href="index.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.home">í™ˆ</a>
                <a href="disease-info.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.disease">ë‡Œì§ˆí™˜ ì •ë³´</a>
                <a href="hospital.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.hospital">ë³‘ì› ê²€ìƒ‰</a>
                <a href="caregivers.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.caregivers">ê°„ë³‘ì¸</a>
                <a href="care-diary.html" class="block px-4 py-2 bg-primary text-white rounded-lg mb-1" data-i18n="menu.careDiary">ê°„ë³‘ì¼ê¸°</a>
                <a href="medical-lens.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.medicalLens">ë©”ë””ì»¬ ë Œì¦ˆ</a>
                <a href="rehab.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.rehab">ì¬í™œìš´ë™</a>
                <a href="community.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.community">ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="medical.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.medical">ëª…ì˜ì°¾ê¸°</a>
                <a href="emergency.html" class="block px-4 py-2 hover:bg-gray-100 rounded-lg" data-i18n="menu.emergency">ì‘ê¸‰</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-28 pb-16">
        <div class="container mx-auto px-4">
            
            <!-- Header Section -->
            <div class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3" data-i18n="careDiary.pageTitle">
                    ğŸ“ ê°„ë³‘ì¼ê¸°
                </h2>
                <p class="text-gray-600 text-lg" data-i18n="careDiary.pageSubtitle">
                    í™˜ìì˜ ì¼ìƒì„ ê¸°ë¡í•˜ê³  ë³´í˜¸ìì™€ ê³µìœ í•˜ì„¸ìš”
                </p>
            </div>

            <!-- Quick Action Buttons -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 md:gap-4 mb-8">
                <button onclick="showRecordModal()" class="btn-primary">
                    <i class="fas fa-plus-circle mr-2"></i>
                    <span data-i18n="careDiary.newRecord">ìƒˆ ê¸°ë¡ ì‘ì„±</span>
                </button>
                <button onclick="startVoiceRecording()" class="btn-secondary">
                    <i class="fas fa-microphone mr-2"></i>
                    <span data-i18n="careDiary.voiceRecord">ìŒì„± ë…¹ìŒ</span>
                </button>
                <button onclick="capturePhoto()" class="btn-secondary">
                    <i class="fas fa-camera mr-2"></i>
                    <span data-i18n="careDiary.takePhoto">ì‚¬ì§„ ì´¬ì˜</span>
                </button>
                <button onclick="uploadMedia()" class="btn-secondary">
                    <i class="fas fa-upload mr-2"></i>
                    <span data-i18n="careDiary.uploadFile">íŒŒì¼ ì—…ë¡œë“œ</span>
                </button>
                <a href="medical-lens.html" class="btn-secondary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; text-decoration: none;">
                    <i class="fas fa-camera-retro mr-2"></i>
                    <span data-i18n="careDiary.medicalLens">ë©”ë””ì»¬ ë Œì¦ˆ</span>
                </a>
            </div>

            <!-- Filter Section -->
            <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                <div class="flex flex-wrap gap-3 items-center">
                    <label class="font-semibold text-gray-700" data-i18n="careDiary.filterBy">í•„í„°:</label>
                    <button class="status-badge medication" onclick="filterDiaries('medication')">
                        <i class="fas fa-pills"></i>
                        <span data-i18n="careDiary.medication">ë³µì•½</span>
                    </button>
                    <button class="status-badge meal" onclick="filterDiaries('meal')">
                        <i class="fas fa-utensils"></i>
                        <span data-i18n="careDiary.meal">ì‹ì‚¬</span>
                    </button>
                    <button class="status-badge vital" onclick="filterDiaries('vital')">
                        <i class="fas fa-heartbeat"></i>
                        <span data-i18n="careDiary.vital">ìƒì²´ì‹ í˜¸</span>
                    </button>
                    <button class="status-badge recovery" onclick="filterDiaries('recovery')">
                        <i class="fas fa-chart-line"></i>
                        <span data-i18n="careDiary.recovery">íšŒë³µìƒíƒœ</span>
                    </button>
                    <button class="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition" onclick="clearFilter()">
                        <span data-i18n="careDiary.showAll">ì „ì²´ë³´ê¸°</span>
                    </button>
                </div>
            </div>

            <!-- Diary Entries -->
            <div id="diary-list" class="space-y-4">
                <!-- Sample Diary Entry -->
                <div class="diary-card bg-white rounded-xl shadow-md p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">2025ë…„ 1ì›” 9ì¼ ì˜¤ì „ ê¸°ë¡</h3>
                            <div class="flex flex-wrap gap-2">
                                <span class="status-badge medication">
                                    <i class="fas fa-pills"></i> ë³µì•½ ì™„ë£Œ
                                </span>
                                <span class="status-badge meal">
                                    <i class="fas fa-utensils"></i> ì•„ì¹¨ì‹ì‚¬ 70%
                                </span>
                            </div>
                        </div>
                        <span class="text-sm text-gray-500">09:30</span>
                    </div>
                    
                    <div class="text-gray-700 mb-4">
                        <p>ì˜¤ëŠ˜ ì•„ì¹¨ í˜ˆì•• ì¸¡ì • ê²°ê³¼ 120/80ìœ¼ë¡œ ì •ìƒ ë²”ìœ„ì…ë‹ˆë‹¤. ì•„ì¹¨ ì•½ ë³µìš© ì™„ë£Œí–ˆìœ¼ë©°, ì‹ì‚¬ëŠ” ì£½ í•œ ê·¸ë¦‡ ì¤‘ 70% ì •ë„ ë“œì…¨ìŠµë‹ˆë‹¤. ê¸°ë¶„ì´ ì¢‹ì•„ ë³´ì´ì‹œê³  ë§ì”€ë„ ì–´ì œë³´ë‹¤ ëª…í™•í•˜ì‹­ë‹ˆë‹¤.</p>
                    </div>
                    
                    <div class="flex gap-3 mb-4">
                        <img src="https://via.placeholder.com/150" alt="í™˜ì ìƒíƒœ" class="media-preview w-32 h-32 object-cover">
                    </div>
                    
                    <div class="flex justify-between items-center pt-4 border-t">
                        <div class="text-sm text-gray-600">
                            <i class="fas fa-user-nurse mr-1"></i> ê°„ë³‘ì¸: ê¹€ê°„ë³‘
                        </div>
                        <div class="flex gap-2">
                            <button class="text-primary hover:text-blue-700" onclick="editDiary(1)">
                                <i class="fas fa-edit mr-1"></i> ìˆ˜ì •
                            </button>
                            <button class="text-success hover:text-green-700" onclick="sendToGuardian(1)">
                                <i class="fas fa-paper-plane mr-1"></i> ë³´í˜¸ì ì „ì†¡
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="text-center py-16 hidden">
                <i class="fas fa-book-open text-6xl text-gray-300 mb-4"></i>
                <h3 class="text-2xl font-bold text-gray-700 mb-2" data-i18n="careDiary.emptyTitle">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                <p class="text-gray-600 mb-6" data-i18n="careDiary.emptySubtitle">ì²« ê°„ë³‘ì¼ê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
                <button onclick="showRecordModal()" class="btn-primary">
                    <i class="fas fa-plus-circle mr-2"></i>
                    <span data-i18n="careDiary.createFirst">ì²« ê¸°ë¡ ì‘ì„±í•˜ê¸°</span>
                </button>
            </div>

        </div>
    </main>

    <!-- Recording Modal -->
    <div id="recordModal" class="modal">
        <div class="modal-content">
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-t-xl">
                <div class="flex justify-between items-center">
                    <h3 class="text-2xl font-bold" data-i18n="careDiary.modal.title">ìƒˆ ê°„ë³‘ì¼ê¸° ì‘ì„±</h3>
                    <button onclick="closeRecordModal()" class="text-white hover:text-gray-200 text-3xl">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- Date and Time -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.dateTime">ë‚ ì§œ ë° ì‹œê°„</label>
                    <input type="datetime-local" id="diaryDateTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>

                <!-- Category Selection -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.category">ì¹´í…Œê³ ë¦¬</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" value="medication" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.medication">ë³µì•½</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" value="meal" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.meal">ì‹ì‚¬</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" value="vital" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.vital">ìƒì²´ì‹ í˜¸</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" value="recovery" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.recovery">íšŒë³µìƒíƒœ</span>
                        </label>
                    </div>
                </div>

                <!-- Voice Recording -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.voiceRecording">ìŒì„± ë…¹ìŒ</label>
                    <div class="flex gap-3">
                        <button id="startRecordBtn" onclick="toggleRecording()" class="btn-primary flex-1">
                            <i class="fas fa-microphone mr-2"></i>
                            <span data-i18n="careDiary.modal.startRecording">ë…¹ìŒ ì‹œì‘</span>
                        </button>
                        <button id="stopRecordBtn" onclick="stopRecording()" class="btn-secondary flex-1 hidden">
                            <i class="fas fa-stop mr-2 recording-pulse"></i>
                            <span data-i18n="careDiary.modal.stopRecording">ë…¹ìŒ ì¤‘ì§€</span>
                        </button>
                    </div>
                    <div id="recordingStatus" class="mt-2 text-sm text-gray-600 hidden">
                        <i class="fas fa-circle text-red-500 recording-pulse mr-2"></i>
                        <span data-i18n="careDiary.modal.recording">ë…¹ìŒ ì¤‘...</span>
                    </div>
                    <input type="file" id="audioUpload" accept="audio/*,.mp3,.wav,.3gp,.amr,.ogg,.opus" class="hidden" onchange="handleAudioUpload(event)">
                    <button onclick="document.getElementById('audioUpload').click()" class="mt-3 text-primary hover:underline">
                        <i class="fas fa-upload mr-2"></i>
                        <span data-i18n="careDiary.modal.uploadAudio">ìŒì„± íŒŒì¼ ì—…ë¡œë“œ</span>
                    </button>
                </div>

                <!-- Photo/Video Capture -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.media">ì‚¬ì§„/ì˜ìƒ</label>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="capturePhotoModal()" class="btn-secondary">
                            <i class="fas fa-camera mr-2"></i>
                            <span data-i18n="careDiary.modal.takePhoto">ì‚¬ì§„ ì´¬ì˜</span>
                        </button>
                        <button onclick="captureVideoModal()" class="btn-secondary">
                            <i class="fas fa-video mr-2"></i>
                            <span data-i18n="careDiary.modal.recordVideo">ì˜ìƒ ì´¬ì˜</span>
                        </button>
                    </div>
                    <input type="file" id="mediaUpload" accept="image/*,video/*" class="hidden" onchange="handleMediaUpload(event)">
                    <button onclick="document.getElementById('mediaUpload').click()" class="mt-3 text-primary hover:underline">
                        <i class="fas fa-upload mr-2"></i>
                        <span data-i18n="careDiary.modal.uploadMedia">íŒŒì¼ ì—…ë¡œë“œ</span>
                    </button>
                    <div id="mediaPreview" class="mt-4"></div>
                </div>

                <!-- Text Content -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.content">ë‚´ìš©</label>
                    <textarea id="diaryContent" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="í™˜ìì˜ ìƒíƒœ, íŠ¹ì´ì‚¬í•­ ë“±ì„ ê¸°ë¡í•˜ì„¸ìš”..."></textarea>
                    <p class="text-sm text-gray-500 mt-2" data-i18n="careDiary.modal.transcriptionNote">* ìŒì„± ë…¹ìŒ ì‹œ ìë™ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ë©ë‹ˆë‹¤</p>
                </div>

                <!-- Guardian Notification -->
                <div class="mb-6">
                    <label class="block text-gray-700 font-semibold mb-2" data-i18n="careDiary.modal.notify">ë³´í˜¸ì ì•Œë¦¼</label>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="notifySMS" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.modal.sms">ë¬¸ì ë©”ì‹œì§€</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="notifyKakao" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.modal.kakao">ì¹´ì¹´ì˜¤í†¡</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="notifyTelegram" class="form-checkbox text-primary">
                            <span data-i18n="careDiary.modal.telegram">í…”ë ˆê·¸ë¨</span>
                        </label>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3">
                    <button onclick="saveDiary()" class="btn-primary flex-1">
                        <i class="fas fa-save mr-2"></i>
                        <span data-i18n="careDiary.modal.save">ì €ì¥</span>
                    </button>
                    <button onclick="saveDraft()" class="btn-secondary">
                        <i class="fas fa-file-alt mr-2"></i>
                        <span data-i18n="careDiary.modal.saveDraft">ì„ì‹œì €ì¥</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
            <footer class="bg-gray-900 text-white py-12 mt-16">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 mb-8 max-w-4xl mx-auto">
            <!-- í”Œë«í¼ ê°œë°œ ë¬¸ì˜ -->
            <div>
                <h3 class="text-xl font-bold mb-4">ğŸ’¼ í”Œë«í¼ ê°œë°œ ë¬¸ì˜</h3>
                <p class="text-gray-400 mb-4 text-sm">QRì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ ë¬¸ì˜í•˜ì„¸ìš”</p>
                <div class="flex gap-4 mb-4 justify-center md:justify-start">
                    <!-- ìœ„ì±— QR -->
                    <div class="text-center">
                        <img src="images/wechat-qr.jpg" alt="WeChat QR Code" class="w-24 h-24 bg-white p-2 rounded-lg mb-2">
                        <p class="text-xs text-gray-400">WeChat</p>
                    </div>
                    <!-- í…”ë ˆê·¸ë¨ QR -->
                    <div class="text-center">
                        <img src="images/telegram-qr.jpg" alt="Telegram QR Code" class="w-24 h-24 bg-white p-2 rounded-lg mb-2">
                        <p class="text-xs text-gray-400">Telegram</p>
                    </div>
                </div>
                <!-- ê°œë°œì ì´ë©”ì¼ -->
                <div class="flex items-center gap-2 text-gray-400 hover:text-white transition justify-center md:justify-start">
                    <i class="fas fa-envelope-open-text text-xl text-blue-400"></i>
                    <div>
                        <p class="text-xs text-gray-500">ê°œë°œì ë¬¸ì˜</p>
                        <a href="mailto:locks88@naver.com" class="text-sm hover:text-blue-400 transition">locks88@naver.com</a>
                    </div>
                </div>
            </div>
            
            <!-- ë¹ ë¥¸ ë§í¬ -->
            <div>
                <h3 class="text-xl font-bold mb-4">âš¡ ë¹ ë¥¸ ë§í¬</h3>
                <ul class="space-y-2 text-gray-400">
                    <li><a href="disease-info.html" class="hover:text-white transition">ë‡Œì§ˆí™˜ ì •ë³´</a></li>
                    <li><a href="hospital.html" class="hover:text-white transition">ë³‘ì› ê²€ìƒ‰</a></li>
                    <li><a href="care-diary.html" class="hover:text-white transition">ê°„ë³‘ì¼ê¸°</a></li>
                    <li><a href="support.html" class="hover:text-white transition">ì§€ì›ì •ì±…</a></li>
                    <li><a href="community.html" class="hover:text-white transition">ì»¤ë®¤ë‹ˆí‹°</a></li>
                    <li><a href="emergency.html" class="hover:text-white text-red-400 transition">ì‘ê¸‰ì •ë³´</a></li>
                </ul>
            </div>
        </div>
        
        <!-- ì €ì‘ê¶Œ -->
        <div class="border-t border-gray-800 pt-8 text-center text-gray-500">
            <p>&copy; 2025 CASHiQ.org - ë‡Œì§ˆí™˜ì¼€ì–´. All rights reserved.</p>
            <p class="text-sm mt-2">ë³¸ ì‚¬ì´íŠ¸ì˜ ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ì „ë¬¸ì˜ì™€ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </div>
    </div>
</footer>

    <!-- Scripts -->
    <script src="js/i18n.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Modal Functions
        function showRecordModal() {
            document.getElementById('recordModal').style.display = 'block';
            // Set current date and time
            const now = new Date();
            const dateTimeStr = now.toISOString().slice(0, 16);
            document.getElementById('diaryDateTime').value = dateTimeStr;
        }

        function closeRecordModal() {
            document.getElementById('recordModal').style.display = 'none';
        }

        // Voice Recording (ê¸°ëŠ¥1, ê¸°ëŠ¥3)
        let mediaRecorder;
        let audioChunks = [];
        let isRecording = false;

        async function toggleRecording() {
            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        audioChunks = [];
                        
                        // ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (Web Speech API ë˜ëŠ” ì„œë²„ API ì‚¬ìš©)
                        await transcribeAudio(audioBlob);
                        
                        document.getElementById('recordingStatus').classList.add('hidden');
                        document.getElementById('startRecordBtn').classList.remove('hidden');
                        document.getElementById('stopRecordBtn').classList.add('hidden');
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    
                    document.getElementById('recordingStatus').classList.remove('hidden');
                    document.getElementById('startRecordBtn').classList.add('hidden');
                    document.getElementById('stopRecordBtn').classList.remove('hidden');
                    
                } catch (error) {
                    console.error('ë§ˆì´í¬ ì ‘ê·¼ ì˜¤ë¥˜:', error);
                    let errorMessage = 'ë§ˆì´í¬ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n';
                    
                    if (error.name === 'NotAllowedError') {
                        errorMessage += 'ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.\në¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ë§ˆì´í¬ ì ‘ê·¼ì„ í—ˆìš©í•˜ì‹  í›„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.';
                    } else if (error.name === 'NotFoundError') {
                        errorMessage += 'ë§ˆì´í¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nê¸°ê¸°ì— ë§ˆì´í¬ê°€ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.';
                    } else if (error.name === 'NotReadableError') {
                        errorMessage += 'ë§ˆì´í¬ê°€ ë‹¤ë¥¸ ì•±ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.\në‹¤ë¥¸ ì•±ì„ ì¢…ë£Œí•˜ì‹  í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    } else {
                        errorMessage += 'ì˜¤ë¥˜: ' + error.message;
                    }
                    
                    alert(errorMessage);
                }
            }
        }

        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                isRecording = false;
            }
        }

        // ìŒì„± íŒŒì¼ ì—…ë¡œë“œ ë° í…ìŠ¤íŠ¸ ë³€í™˜
        async function handleAudioUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const formData = new FormData();
                formData.append('audio', file);
                
                // ì„œë²„ë¡œ ì „ì†¡í•˜ì—¬ í…ìŠ¤íŠ¸ ë³€í™˜ (ì‹¤ì œ êµ¬í˜„ ì‹œ API ì—”ë“œí¬ì¸íŠ¸ í•„ìš”)
                alert(`ìŒì„± íŒŒì¼ "${file.name}" ì—…ë¡œë“œë¨. í…ìŠ¤íŠ¸ ë³€í™˜ ê¸°ëŠ¥ì€ ì„œë²„ APIê°€ í•„ìš”í•©ë‹ˆë‹¤.`);
                
                // ì„ì‹œ: íŒŒì¼ ì •ë³´ í‘œì‹œ
                const content = document.getElementById('diaryContent');
                content.value += `\n[ìŒì„± íŒŒì¼: ${file.name}]\n`;
            }
        }

        // ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (Web Speech API ì‚¬ìš© ì˜ˆì‹œ)
        async function transcribeAudio(audioBlob) {
            // ì‹¤ì œ êµ¬í˜„: ì„œë²„ API ë˜ëŠ” Web Speech API ì‚¬ìš©
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ì‹œë®¬ë ˆì´ì…˜
            const content = document.getElementById('diaryContent');
            content.value += '\n[ë…¹ìŒëœ ë‚´ìš©ì´ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ë©ë‹ˆë‹¤]\n';
            
            alert('ìŒì„±ì´ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œ êµ¬í˜„ ì‹œ ìŒì„±ì¸ì‹ APIê°€ í•„ìš”í•©ë‹ˆë‹¤.');
        }

        // Photo/Video Capture (ê¸°ëŠ¥2)
        async function capturePhotoModal() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                const video = document.createElement('video');
                video.srcObject = stream;
                video.autoplay = true;
                video.style.width = '100%';
                video.style.borderRadius = '8px';
                
                const preview = document.getElementById('mediaPreview');
                preview.innerHTML = '';
                preview.appendChild(video);
                
                const captureBtn = document.createElement('button');
                captureBtn.className = 'btn-primary mt-3 w-full';
                captureBtn.innerHTML = '<i class="fas fa-camera mr-2"></i> ì´¬ì˜';
                captureBtn.onclick = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    canvas.getContext('2d').drawImage(video, 0, 0);
                    
                    const img = document.createElement('img');
                    img.src = canvas.toDataURL('image/jpeg');
                    img.className = 'media-preview';
                    
                    preview.innerHTML = '';
                    preview.appendChild(img);
                    
                    stream.getTracks().forEach(track => track.stop());
                    
                    alert('ì‚¬ì§„ì´ ì´¬ì˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œ êµ¬í˜„ ì‹œ ë³´í˜¸ìì—ê²Œ ì „ì†¡ë©ë‹ˆë‹¤.');
                };
                
                preview.appendChild(captureBtn);
                
            } catch (error) {
                console.error('ì¹´ë©”ë¼ ì ‘ê·¼ ì˜¤ë¥˜:', error);
                let errorMessage = 'ì¹´ë©”ë¼ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n';
                
                if (error.name === 'NotAllowedError') {
                    errorMessage += 'ì¹´ë©”ë¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.\në¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì¹´ë©”ë¼ ì ‘ê·¼ì„ í—ˆìš©í•˜ì‹  í›„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.';
                } else if (error.name === 'NotFoundError') {
                    errorMessage += 'ì¹´ë©”ë¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nê¸°ê¸°ì— ì¹´ë©”ë¼ê°€ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.';
                } else if (error.name === 'NotReadableError') {
                    errorMessage += 'ì¹´ë©”ë¼ê°€ ë‹¤ë¥¸ ì•±ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.\në‹¤ë¥¸ ì•±ì„ ì¢…ë£Œí•˜ì‹  í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                } else if (error.name === 'OverconstrainedError') {
                    errorMessage += 'ìš”ì²­í•œ ì¹´ë©”ë¼ ì„¤ì •ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                } else {
                    errorMessage += 'ì˜¤ë¥˜: ' + error.message;
                }
                
                alert(errorMessage);
            }
        }

        async function captureVideoModal() {
            alert('ì˜ìƒ ì´¬ì˜ ê¸°ëŠ¥ì€ ì¹´ë©”ë¼ ì ‘ê·¼ í›„ ë…¹í™” ê¸°ëŠ¥ìœ¼ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤.');
        }

        function handleMediaUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const preview = document.getElementById('mediaPreview');
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    if (file.type.startsWith('image/')) {
                        preview.innerHTML = `<img src="${e.target.result}" class="media-preview">`;
                    } else if (file.type.startsWith('video/')) {
                        preview.innerHTML = `<video src="${e.target.result}" class="media-preview" controls></video>`;
                    }
                };
                
                reader.readAsDataURL(file);
            }
        }

        // Save Diary (ê¸°ëŠ¥4)
        function saveDiary() {
            const dateTime = document.getElementById('diaryDateTime').value;
            const content = document.getElementById('diaryContent').value;
            
            if (!dateTime || !content) {
                alert('ë‚ ì§œì™€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // localStorageì— ì €ì¥ (íšŒì› ê¸°ëŠ¥ ì‹œ ì„œë²„ API ì‚¬ìš©)
            const diaries = JSON.parse(localStorage.getItem('care_diaries') || '[]');
            const newDiary = {
                id: Date.now(),
                dateTime: dateTime,
                content: content,
                categories: getSelectedCategories(),
                notifications: getSelectedNotifications(),
                createdAt: new Date().toISOString()
            };
            
            diaries.push(newDiary);
            localStorage.setItem('care_diaries', JSON.stringify(diaries));
            
            // ë³´í˜¸ìì—ê²Œ ì•Œë¦¼ ì „ì†¡ (ì‹¤ì œ êµ¬í˜„ ì‹œ API í•„ìš”)
            sendNotificationsToGuardian(newDiary);
            
            alert('ê°„ë³‘ì¼ê¸°ê°€ ì €ì¥ë˜ê³  ë³´í˜¸ìì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            closeRecordModal();
            loadDiaries();
        }

        function saveDraft() {
            alert('ì„ì‹œì €ì¥ ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function getSelectedCategories() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"][value]');
            const selected = [];
            checkboxes.forEach(cb => {
                if (cb.checked && cb.value !== 'on') {
                    selected.push(cb.value);
                }
            });
            return selected;
        }

        function getSelectedNotifications() {
            return {
                sms: document.getElementById('notifySMS').checked,
                kakao: document.getElementById('notifyKakao').checked,
                telegram: document.getElementById('notifyTelegram').checked
            };
        }

        function sendNotificationsToGuardian(diary) {
            const notifications = diary.notifications;
            
            // ì‹¤ì œ êµ¬í˜„ ì‹œ ì„œë²„ APIë¥¼ í†µí•´ ì „ì†¡
            console.log('ë³´í˜¸ì ì•Œë¦¼ ì „ì†¡:', notifications);
            
            if (notifications.sms) {
                console.log('SMS ì „ì†¡:', diary.content);
            }
            if (notifications.kakao) {
                console.log('ì¹´ì¹´ì˜¤í†¡ ì „ì†¡:', diary.content);
            }
            if (notifications.telegram) {
                console.log('í…”ë ˆê·¸ë¨ ì „ì†¡:', diary.content);
            }
        }

        // Filter Functions
        function filterDiaries(category) {
            alert(`${category} ì¹´í…Œê³ ë¦¬ë¡œ í•„í„°ë§`);
        }

        function clearFilter() {
            loadDiaries();
        }

        // Load Diaries
        function loadDiaries() {
            const diaries = JSON.parse(localStorage.getItem('care_diaries') || '[]');
            // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ë¡œì§
            console.log('Loaded diaries:', diaries);
        }

        // Quick Action Functions
        function startVoiceRecording() {
            showRecordModal();
            setTimeout(() => toggleRecording(), 500);
        }

        function capturePhoto() {
            showRecordModal();
            setTimeout(() => capturePhotoModal(), 500);
        }

        function uploadMedia() {
            showRecordModal();
            setTimeout(() => document.getElementById('mediaUpload').click(), 500);
        }

        // Edit and Send Functions
        function editDiary(id) {
            alert(`ì¼ê¸° ${id} ìˆ˜ì •`);
        }

        function sendToGuardian(id) {
            alert(`ì¼ê¸° ${id}ë¥¼ ë³´í˜¸ìì—ê²Œ ì „ì†¡í•©ë‹ˆë‹¤.`);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('recordModal');
            if (event.target == modal) {
                closeRecordModal();
            }
        }

        // Initialize
        loadDiaries();
    </script>
</body>
</html>
